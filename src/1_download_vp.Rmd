---
title: "Download bird profile data from the ENRAM data repository"
author: "Peter Desmet"
output:
  html_document:
    toc: yes
    toc_depth: 1
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
library(bioRad)
```

The steps described in this document can be skipped if you already have all the required bird profile data stored locally. You will need the bioRad package for the next steps too though, so make sure it is installed.

## 1. Install bioRad

Follow step 1 to 3 of the [bioRad installation instructions](https://github.com/adokter/bioRad#installation). Until [this pull request is accepted](https://github.com/adokter/bioRad/pull/32), replace step 3 by:

```{r eval=FALSE}
# Install bioRad from the vignettes branch on ENRAM
library(devtools)
install_github("enram/bioRad", ref="vignettes")
```

## 2. Define download settings

Define your download settings/filters, such as the date range, countries, and radars to include and where the bird profile data should be stored locally (a file path relative to this script):

```{r}
download_settings <- list()
download_settings[["start_date"]]   <- "2017-03-01"
download_settings[["end_date"]]     <- "2017-04-30"
download_settings[["countries"]]    <- c("se")
download_settings[["radars"]]       <- c("ang", "kkr")
download_settings[["raw_data_dir"]] <- "../data/raw/" # Needs a trailing slash!
```

## 3. Download bird profile data

Download the data from the [ENRAM bird profile data repository](http://enram.github.io/data-repository). Note that this step might take some time:

```{r results="hide", eval=FALSE}
bioRad::download_vp(
  start_date = download_settings$start_date,
  end_date = download_settings$end_date,
  country = download_settings$countries,
  radar = download_settings$radars,
  localpath = download_settings$raw_data_dir
)
```

Once you have all the data stored locally, go to [the next step](2_vp_to_csv.Rmd) to export those to a CSV file.
